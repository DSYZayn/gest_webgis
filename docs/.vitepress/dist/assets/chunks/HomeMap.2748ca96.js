import{l as v}from"./namespace.4bc4eca3.js";import{E as w}from"./index.6d6f9088.js";import{E}from"./index.02feb12e.js";import{d as g,h as m,j as y,o as I,c as L,a as f,t as M,H as c,l as s,k as i,w as T,e as R}from"./framework.0ef9fb42.js";import"./dispatch.5e20a8fc.js";import"./value.823184c1.js";import"./isArray.61ae368f.js";import"./bisect.681d2435.js";import"./index.aba9eb53.js";import"./get.3dd6c794.js";import"./memoize.b774fe52.js";function S(u,e,l){if(u===void 0)throw new Error("请输入天地图开发者密钥！");const a=e.split("_")[0],r=e.split("_")[1],n=l.split("_")[0],p=l.split("_")[1],d=new v.TileLayer("https://{s}.tianditu.gov.cn/"+l+"/wmts?f=pbf&SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER="+n+"&STYLE=default&TILEMATRIXSET="+p+"&FORMAT=tiles&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&tk="+u,{subdomains:["t0","t1","t2","t3","t4","t5","t6","t7"]});return[new v.TileLayer("https://{s}.tianditu.gov.cn/"+e+"/wmts?f=pbf&SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER="+a+"&STYLE=default&TILEMATRIXSET="+r+"&FORMAT=tiles&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&tk="+u,{subdomains:["t0","t1","t2","t3","t4","t5","t6","t7"]}),d]}const b={class:"relative w-full h-full"},h={key:0,class:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-full"},C=i("br",null,null,-1),x=i("br",null,null,-1),V=i("br",null,null,-1),k={class:"buttons flex flex-row gap-2"},A=i("div",{id:"map",class:"w-[98%] h-[98%] left-[1%] top-[1%] focus-visible:outline-none z-0"},null,-1),G=g({__name:"HomeMap",setup(u){const e=m(!1),l=m(!0),a=m(""),r=m("请前往天地图官网获取");function n(d){try{e.value=!1,l.value=!0;const[t,o]=S(d,"vec_w","cva_w");fetch(t.getTileUrl(new v.Point(429,183))).then(_=>{new v.Map("map",{preferCanvas:!0,minZoom:3,maxZoom:18,attributionControl:!1,zoomControl:!0,layers:[t,o],center:[44.817831,123.08026],zoom:9,worldCopyJump:!0}),l.value=!1,e.value=!1}).catch(_=>{console.log(_),e.value=!0})}catch(t){console.log(t),e.value=!0}}y(()=>{n({}.VITE_TXXXNDIT_KEY)});const p="4267820f43926eaf808d61dc07269beb";return(d,t)=>(I(),L("div",b,[l.value?(I(),L("div",h,[f(M(e.value?"未获取到天地图图层， 请输入天地图key!":"加载中...")+" ",1),C,c(s(w),{modelValue:a.value,"onUpdate:modelValue":t[0]||(t[0]=o=>a.value=o),onChange:t[1]||(t[1]=o=>n(a.value)),placeholder:r.value},null,8,["modelValue","placeholder"]),x,V,i("div",k,[c(s(E),{onClick:t[2]||(t[2]=o=>n(a.value)),type:"primary"},{default:T(()=>[f("重新加载")]),_:1}),c(s(E),{onClick:t[3]||(t[3]=o=>n(s(p))),type:"primary",onMouseenter:t[4]||(t[4]=o=>r.value=s(p)),onMouseleave:t[5]||(t[5]=o=>r.value="请前往天地图官网获取")},{default:T(()=>[f("使用临时秘钥")]),_:1}),c(s(E),{type:"primary",tag:"a",href:"http://lbs.tianditu.gov.cn/server/MapService.html",target:"_blank",style:{color:"white","text-decoration":"none"}},{default:T(()=>[f(" 前往天地图官网 ")]),_:1})])])):R("",!0),A]))}});export{G as default};
